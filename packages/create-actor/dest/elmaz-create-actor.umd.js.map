{"version":3,"file":"elmaz-create-actor.umd.js","sources":["../../emitter/dest/index.es.js","../index.js"],"sourcesContent":["function emitter (events) {\n  events = Object.assign({}, events);\n\n  const app = {\n    events,\n    on (name, listener) {\n      (events[name] || (events[name] = [])).push(listener);\n    },\n\n    off (name, listener) {\n      if (events[name] && listener) {\n        events[name].splice(events[name].indexOf(listener) >>> 0, 1);\n      } else if (name && !listener) {\n        app.events[name] = events[name] = [];\n      } else {\n        app.events = events = {};\n      }\n    },\n\n    // eslint-disable-next-line\n    emit(name, a, b, c) {\n      (events[name] || []).map((listener) => {\n        listener(a, b, c);\n      })\n      ;(events['*'] || []).map((listener) => {\n        listener(name, a, b, c);\n      });\n    },\n\n    use (plugin) {\n      return Object.assign({}, app, plugin(app))\n    },\n  };\n\n  return app\n}\n\nexport default emitter;\n","import emitter from '@elmaz/emitter'\n\nfunction createActor (actions) {\n  const actor = emitter()\n  actor._rawActions = Object.assign({}, actions)\n\n  actor.connect = (store) => {\n    actor.store = store\n\n    // eslint-disable-next-line\n    actor.dispatch = (actionName, aa, bb, cc) => {\n      actor.actions[actionName](aa, bb, cc)\n    }\n\n    actor.actions = Object.keys(actor._rawActions).reduce((memo, name) => {\n      memo[name] = function action_ (a, b, c) {\n        actor.emit('action', name, a, b, c)\n\n        const context = {\n          emit: actor.emit,\n          state: actor.store.state,\n          actions: actor.actions,\n          dispatch: actor.dispatch,\n          update: (val) => (store) => Object.assign({}, store.state, val),\n        }\n\n        let result = null\n\n        try {\n          result = actor._rawActions[name](context, a, b, c)\n        } catch (er) {\n          actor.emit('error', er)\n        }\n\n        // if `result` is function, action is reducer\n        if (typeof result === 'function') {\n          const oldState = Object.assign({}, store.state)\n          // intentionally hard update the state,\n          // because we provide \"soft update\" to each action\n          store.state = store.update(result({ state: oldState }), true)\n\n          actor.emit('stateChange', {\n            prev: oldState,\n            state: store.state,\n          })\n          return null\n        }\n\n        // otherwise, assumes action is effect\n        return result\n      }\n\n      return memo\n    }, {})\n  }\n\n  return actor\n}\n\nexport default createActor\n"],"names":["emitter","events","const","app","Object","assign","on","name","listener","push","off","splice","indexOf","emit","a","b","c","map","use","plugin","actions","actor","_rawActions","connect","store","dispatch","actionName","aa","bb","cc","keys","reduce","memo","context","state","update","val","result","er","oldState","prev"],"mappings":"4LAAA,SAASA,EAASC,GAGhBC,IAAMC,GACJF,OAHFA,EAASG,OAAOC,UAAWJ,GAIzBK,YAAIC,EAAMC,IACPP,EAAOM,KAAUN,EAAOM,QAAaE,KAAKD,IAG7CE,aAAKH,EAAMC,GACLP,EAAOM,IAASC,EAClBP,EAAOM,GAAMI,OAAOV,EAAOM,GAAMK,QAAQJ,KAAc,EAAG,GACjDD,IAASC,EAClBL,EAAIF,OAAOM,GAAQN,EAAOM,MAE1BJ,EAAIF,OAASA,MAKjBY,cAAKN,EAAMO,EAAGC,EAAGC,IACdf,EAAOM,QAAaU,IAAI,SAACT,GACxBA,EAASM,EAAGC,EAAGC,MAEff,EAAO,UAAYgB,IAAI,SAACT,GACxBA,EAASD,EAAMO,EAAGC,EAAGC,MAIzBE,aAAKC,GACH,OAAOf,OAAOC,UAAWF,EAAKgB,EAAOhB,MAIzC,OAAOA,SChCT,SAAsBiB,GACpBlB,IAAMmB,EAAQrB,IAqDd,OApDAqB,EAAMC,YAAclB,OAAOC,UAAWe,GAEtCC,EAAME,QAAU,SAACC,GACfH,EAAMG,MAAQA,EAGdH,EAAMI,SAAW,SAACC,EAAYC,EAAIC,EAAIC,GACpCR,EAAMD,QAAQM,GAAYC,EAAIC,EAAIC,IAGpCR,EAAMD,QAAUhB,OAAO0B,KAAKT,EAAMC,aAAaS,OAAO,SAACC,EAAMzB,GAsC3D,OArCAyB,EAAKzB,GAAQ,SAAkBO,EAAGC,EAAGC,GACnCK,EAAMR,KAAK,SAAUN,EAAMO,EAAGC,EAAGC,GAEjCd,IAAM+B,GACJpB,KAAMQ,EAAMR,KACZqB,MAAOb,EAAMG,MAAMU,MACnBd,QAASC,EAAMD,QACfK,SAAUJ,EAAMI,SAChBU,OAAQ,SAACC,UAAQ,SAACZ,UAAUpB,OAAOC,UAAWmB,EAAMU,MAAOE,MAGzDC,EAAS,KAEb,IACEA,EAAShB,EAAMC,YAAYf,GAAM0B,EAASnB,EAAGC,EAAGC,GAChD,MAAOsB,GACPjB,EAAMR,KAAK,QAASyB,GAItB,GAAsB,mBAAXD,EAAuB,CAChCnC,IAAMqC,EAAWnC,OAAOC,UAAWmB,EAAMU,OASzC,OANAV,EAAMU,MAAQV,EAAMW,OAAOE,GAASH,MAAOK,KAAa,GAExDlB,EAAMR,KAAK,eACT2B,KAAMD,EACNL,MAAOV,EAAMU,QAER,KAIT,OAAOG,GAGFL,QAIJX"}