!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.elmaz={})}(this,function(t){"use strict";function e(t,e){var n={emit:e.emit,store:e.store,actions:e.actions,dispatch:e.dispatch},i=null,s=function(e,n,s){return i=t(e,n,s)};return e.off("stateChange"),e.on("stateChange",function(t){n=Object.assign({},n,t),e.emit("render",s,n,i)}),e.emit("render",s,n,i),i}function n(t){var e={events:t=Object.assign({},t),on:function(e,n){(t[e]||(t[e]=[])).push(n)},off:function(n,i){t[n]&&i?t[n].splice(t[n].indexOf(i)>>>0,1):n&&!i?e.events[n]=t[n]=[]:e.events=t={}},emit:function(e,n,i,s){(t[e]||[]).map(function(t){t(n,i,s)}),(t["*"]||[]).map(function(t){t(e,n,i,s)})},use:function(t){return Object.assign({},e,t(e))}};return e}function i(t){var e=n();return e._rawActions=Object.assign({},t),e.connect=function(t){e.store=t,e.dispatch=function(t,n,i,s){e.actions[t](n,i,s)},e.actions=Object.keys(e._rawActions).reduce(function(n,i){return n[i]=function(n,s,c){e.emit("action",i,n,s,c);var a={emit:e.emit,state:e.store.state,actions:e.actions,dispatch:e.dispatch,update:function(t){return function(e){return Object.assign({},e.state,t)}}},r=null;try{r=e._rawActions[i](a,n,s,c)}catch(t){e.emit("error",t)}if("function"==typeof r){var o=Object.assign({},t.state);return t.state=t.update(r({state:o}),!0),e.emit("stateChange",{prev:o,state:t.state}),null}return r},n},{})},e}function s(t,e){function n(e,i){return e?(n.state=i?Object.assign({},e):Object.assign({},t,e),n.state):null}return t=Object.assign({},t),n.update=n,n.state=n.state||t,n._name=e,n}t.elmaz=function(t){var n=i((t=Object.assign({},t)).actions);return n.connect(s(t.state,t.name)),n.options=t,t.view&&(n.on("render",function(t,e){return t(e)}),n.tree=e(t.view,n)),n},t.createActor=i,t.createStore=s,t.createView=e,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=elmaz.umd.js.map
